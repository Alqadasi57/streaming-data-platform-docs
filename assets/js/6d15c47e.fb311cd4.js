"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2305],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},23181:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={sidebar_position:5},o="Pools API",s={unversionedId:"examples/dextrades/pools-api",id:"examples/dextrades/pools-api",title:"Pools API",description:"With the Pools API, developers can easily retrieve information about liquidity providers, trading volumes, fees, and other key metrics for a variety of different pools.",source:"@site/docs/examples/dextrades/pools-api.md",sourceDirName:"examples/dextrades",slug:"/examples/dextrades/pools-api",permalink:"/docs/examples/dextrades/pools-api",draft:!1,editUrl:"https://github.com/bitquery/streaming-data-platform-docs/tree/main/docs/examples/dextrades/pools-api.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Getting Latest Pairs",permalink:"/docs/examples/dextrades/latest-trading-pairs-api"},next:{title:"Token Trades API",permalink:"/docs/examples/dextrades/token-trades-apis"}},l={},p=[{value:"Latest pools for a specific DEX",id:"latest-pools-for-a-specific-dex",level:2},{value:"Trade Stats for a particular Pool on a specific DEX",id:"trade-stats-for-a-particular-pool-on-a-specific-dex",level:2}],d={toc:p},u="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"pools-api"},"Pools API"),(0,r.kt)("p",null,"With the Pools API, developers can easily retrieve information about liquidity providers, trading volumes, fees, and other key metrics for a variety of different pools."),(0,r.kt)("h2",{id:"latest-pools-for-a-specific-dex"},"Latest pools for a specific DEX"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  EVM(dataset: combined, network: eth) {\n    Events(\n      orderBy: {descending: Block_Number}\n      limit: {count: 10}\n      where: {Log: {SmartContract: {is: "0x1f98431c8ad98523631ae4a59f267346ea31f984"}, Signature: {Name: {is: "PoolCreated"}}}}\n    ) {\n      Log {\n        Signature {\n          Name\n          Parsed\n          Signature\n        }\n        SmartContract\n      }\n      Transaction {\n        Hash\n      }\n      Block {\n        Date\n        Number\n      }\n      Arguments {\n        Path {\n          Name\n        }\n        Type {\n          Name\n        }\n        Value {\n          String\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"You can find the query ",(0,r.kt)("a",{parentName:"p",href:"https://graphql.bitquery.io/ide/Latest-pools-created-uniswap-v3"},"here")),(0,r.kt)("p",null," ",(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dataset"),': Specifies the dataset used for the query. In this case, it is set to "combined".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"network"),': Specifies the network on which the query is executed. In this case, it is set to "eth".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"where"),': A filter used to retrieve events related to the creation of a Uniswap V2 pool on the specified DEX. It is applied to both "Log" and "Signature" objects and uses the "is" operator to specify the smart contract address of the DEX and the name of the event signature respectively.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"orderBy"),": Specifies the order in which the events are returned. In this case, it is ordered in descending order based on block number."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"limit"),": Limits the number of events returned in the query. In this case, it is set to 10.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returned Data")," "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Log"),": Returns information about the log event, including the signature and the smart contract address."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Transaction"),": Returns information about the transaction in which the event occurred, including the transaction hash."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Block"),": Returns information about the block in which the event occurred, including the block number and the block timestamp."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Arguments"),": Returns the arguments associated with the event, including the token addresses and initial liquidity of the pool.")),(0,r.kt)("p",null,"Based on the arguments used we can query the latest pools using ",(0,r.kt)("a",{parentName:"p",href:"https://graphql.bitquery.io/ide/Latest-Pair-Created-by-timeStamp-after"},"this query below")," in the ",(0,r.kt)("a",{parentName:"p",href:"https://graphql.bitquery.io"},"https://graphql.bitquery.io")," endpoint."),(0,r.kt)("p",null,"The following GraphQL query retrieves data on the latest 50 PairCreated events on the Ethereum network, along with their associated block timestamp, token0 address and name. It uses the ethereum network and the arguments from the query above to filter events based on specific criteria."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  ethereum(network: ethereum) {\n    arguments(\n      options: {desc: ["block.timestamp.time"], limit: 50}\n      smartContractEvent: {is: "PairCreated"}\n      time: {after: "2023-03-11T18:47:55+00:00"}\n    ) {\n      block {\n        timestamp {\n          time(format: "%Y-%m-%d %H:%M:%S")\n        }\n      }\n      token0: any(of: argument_value, argument: {is: "token0"})\n      token0Name: any(of: argument_value, argument: {is: "token0"}, as: token_name)\n    }\n  }\n}\n')),(0,r.kt)("p",null," ",(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"network"),': Specifies the network used for the query. In this case, it is set to "ethereum".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"smartContractEvent"),": Filters the events to include only those with the ",(0,r.kt)("inlineCode",{parentName:"li"},"PairCreated")," event signature."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"time"),": Filters the events to include only those occurring after the specified time."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"options"),": Specifies additional options for the query. In this case, it sorts the events in descending order based on block timestamp and limits the number of events returned to 50.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returned Data")," "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"block"),": Returns information about the block in which the event occurred, including the block timestamp."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"timestamp"),": Returns the block timestamp in a specified format."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"token0"),": Returns the ",(0,r.kt)("inlineCode",{parentName:"li"},"token0")," address associated with the event."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"token0Name"),": Returns the name of the ",(0,r.kt)("inlineCode",{parentName:"li"},"token0")," token, using the ",(0,r.kt)("inlineCode",{parentName:"li"},"as")," parameter to specify the field name.")),(0,r.kt)("h2",{id:"trade-stats-for-a-particular-pool-on-a-specific-dex"},"Trade Stats for a particular Pool on a specific DEX"),(0,r.kt)("p",null,"Here's an example GraphQL query that retrieves the sum of sell amounts for trades between WETH and USDT made on the Uniswap V3 exchange ."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'query MyQuery {\n  EVM(dataset: combined, network: eth) {\n    DEXTrades(\n      where: {Block: {Date: {after: "2023-03-12"}}, Trade: {Dex: {SmartContract: {is: "0x11b815efB8f581194ae79006d24E0d814B7697F6"}}}} ##Uniswap V3 pool to exchange between WETH and USDT.\n    ) {\n      sum(of: Trade_Sell_Amount)\n      Block {\n        Date\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"You can find the query ",(0,r.kt)("a",{parentName:"p",href:"https://graphql.bitquery.io/ide/Daily-Trade-Amount-of-a-Pool"},"here")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Parameters")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dataset"),' : Specifies the dataset used for the query. In this case, it is set to "combined".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"network"),' : Specifies the network on which the query is executed. In this case, it is set to "eth".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"where"),' : A filter used to retrieve trades executed on the Uniswap V3 exchange for WETH and USDT within a specific time period. It is applied to both "Block" and "Trade" objects and uses the "after" operator to specify the start date of the time period. The "is" operator is used to specify the smart contract address of the Uniswap V3 pool used for the exchange.')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returned Data")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"sum"),' : Calculates the sum of a specific field, which in this case is "Trade_Sell_Amount".'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Block"),' : Returns information about the block in which the trade was executed, including the date of the block in the "Date" subfield.')))}c.isMDXComponent=!0}}]);